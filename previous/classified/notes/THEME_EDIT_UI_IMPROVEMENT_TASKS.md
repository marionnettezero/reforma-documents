# テーマ編集画面UI改善タスク

## 概要

テーマ編集モーダルのUIを改善し、アコーディオンで整理し、スクロール可能にします。

## 現状確認（2026-01-20）

### 編集モーダルの現在の構造

**ファイル**: `src/pages/system/ThemeListPage.tsx` (1048-1380行目)

1. **タイトル**: `t("theme_edit") || "テーマ編集"` (1051行目)
   - ⚠️ 多言語キーが適切でない可能性

2. **テーマコード** (1062-1073行目)
   - 個別に表示（読み取り専用）

3. **テーマ名** (1074-1090行目)
   - 個別に表示（必須項目）

4. **説明** (1091-1100行目)
   - 個別に表示

5. **テーマトークン (JSON)** (1101-1119行目)
   - 個別に表示（必須項目）
   - ヒント文あり

6. **カスタムスタイル設定** (1121-1347行目)
   - ヘッダ/フッタ設定 (1125-1212行目)
   - 詳細カスタマイズ (1214-1346行目)
     - コンテナ、カード、プライマリボタン、セカンダリボタン、入力フィールドのアコーディオン
     - グローバルCSS

7. **有効/無効チェックボックス** (1349-1358行目)

8. **ボタン** (1360-1377行目)

### ConfirmDialogコンポーネント

**ファイル**: `src/components/ConfirmDialog.tsx`

- 現在、コンテンツエリアにスクロール機能がない
- `children`部分に`max-height`と`overflow-y`を追加する必要がある

## 修正要件

### 1. タイトルの多言語対応
- **現状**: `t("theme_edit") || "テーマ編集"`
- **修正**: 適切な多言語キーを使用（例: `t("theme_edit_title")` または既存の適切なキーを確認）

### 2. 基本情報アコーディオン
- **内容**: テーマコード、テーマ名、説明
- **タイトル**: 「基本情報」（多言語対応）
- **デフォルト**: 開く（`defaultOpen={true}`）

### 3. テーマトークンアコーディオン
- **内容**: テーマトークン (JSON) とヒント文
- **タイトル**: 「テーマトークン (JSON)※旧スタイル情報」（多言語対応）
- **配置**: 最後（カスタムスタイル設定の後）
- **デフォルト**: 閉じる（`defaultOpen={false}`）

### 4. カスタムスタイル設定アコーディオン
- **内容**: 
  - ヘッダ/フッタ設定
  - 詳細カスタマイズ（コンテナ、カード、ボタン、入力フィールドの子アコーディオン）
  - グローバルCSS
- **タイトル**: 「カスタムスタイル設定」（多言語対応）
- **デフォルト**: 閉じる（`defaultOpen={false}`）
- **構造**: 親アコーディオン内に子アコーディオンを含む

### 5. スクロール対応
- **対象**: モーダルのコンテンツエリア
- **方法**: ConfirmDialogの`children`部分に`max-height`と`overflow-y-auto`を追加
- **注意**: ボタンエリアは固定し、コンテンツエリアのみスクロール

## タスクリスト

### タスク1: タイトルの多言語対応
- [ ] 既存の多言語キーを確認（`theme_edit`が適切か確認）
- [ ] 必要に応じて多言語キーを追加または修正
- [ ] タイトルを適切な多言語キーに変更

### タスク2: 基本情報アコーディオンの追加
- [ ] テーマコード、テーマ名、説明を`AccordionItem`で囲む
- [ ] タイトルを「基本情報」に設定（多言語対応）
- [ ] `defaultOpen={true}`を設定
- [ ] 多言語キーを追加（例: `theme_basic_info`）

### タスク3: テーマトークンアコーディオンの追加
- [ ] テーマトークン(JSON)とヒント文を`AccordionItem`で囲む
- [ ] タイトルを「テーマトークン (JSON)※旧スタイル情報」に設定（多言語対応）
- [ ] `defaultOpen={false}`を設定
- [ ] カスタムスタイル設定の後に配置
- [ ] 多言語キーを追加（例: `theme_tokens_legacy`）

### タスク4: カスタムスタイル設定アコーディオンの統合
- [ ] カスタムスタイル設定全体を`AccordionItem`で囲む
- [ ] タイトルを「カスタムスタイル設定」に設定（多言語対応）
- [ ] `defaultOpen={false}`を設定
- [ ] ヘッダ/フッタ設定と詳細カスタマイズを含める
- [ ] 詳細カスタマイズの子アコーディオン（コンテナ、カード等）を維持
- [ ] 多言語キーを追加（例: `theme_custom_style_config`）

### タスク5: スクロール対応
- [ ] ConfirmDialogの`children`部分に`max-height`と`overflow-y-auto`を追加
- [ ] モーダルの高さを適切に制限（例: `max-h-[calc(100vh-8rem)]`）
- [ ] ボタンエリアは固定し、コンテンツエリアのみスクロール
- [ ] 動作確認（縦に長い場合にスクロール可能か確認）

## 実装詳細

### アコーディオンの構造

```
編集モーダル
├─ 基本情報（開く）
│  ├─ テーマコード
│  ├─ テーマ名
│  └─ 説明
├─ カスタムスタイル設定（閉じる）
│  ├─ ヘッダ/フッタ設定
│  └─ 詳細カスタマイズ
│     ├─ コンテナ（閉じる）
│     ├─ カード（閉じる）
│     ├─ プライマリボタン（閉じる）
│     ├─ セカンダリボタン（閉じる）
│     ├─ 入力フィールド（閉じる）
│     └─ グローバルCSS
├─ テーマトークン (JSON)※旧スタイル情報（閉じる）
├─ 有効/無効チェックボックス
└─ ボタン（更新、キャンセル）
```

### スクロール対応の実装

ConfirmDialogの`children`部分を以下のように修正：

```tsx
{props.children ? (
  <div className="mt-4 max-h-[calc(100vh-12rem)] overflow-y-auto">
    {props.children}
  </div>
) : null}
```

または、編集モーダル内のコンテンツ部分を直接スクロール可能にする：

```tsx
<div className="space-y-4 max-h-[calc(100vh-16rem)] overflow-y-auto">
  {/* コンテンツ */}
</div>
```

## 注意点

1. **多言語対応**: すべての新しいラベルに多言語キーを追加
2. **アコーディオンのネスト**: カスタムスタイル設定内の子アコーディオンが正しく動作するか確認
3. **スクロール範囲**: ボタンエリアはスクロール範囲外に配置
4. **レスポンシブ**: モバイルでも適切に表示されるか確認

## 進捗状況

- **全体進捗**: 0/5 タスク完了（0%）
- **最終更新**: 2026-01-20
- **完了タスク**: なし
- **進行中タスク**: なし
- **未着手タスク**: タスク1-5（すべて）
